name: Deploy Infrastructure

on:
  push:
    branches: [main]
    paths:
      - 'infrastructure.yml'
      - '.github/workflows/infrastructure.yml'
      - '.github/workflows/ecr-repository.yml'

jobs:
  upsert-ecr-repository:
    uses: ./.github/workflows/ecr-repository.yml
    with:
      role: us-east-1
      region: arn:aws:iam::${{ secrets.AWS_ACCOUNT_ID }}:role/code-runner-pipeline-role
